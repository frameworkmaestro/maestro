<div id="annoLayout" style="width:100%;height:100%;">
    <div id="annoLeftPane" region="west" split="true" title="Constructions" style="height: 100%">
        <div style="padding:5px"><input id="cxn" name="cxn" type="text" style="width:200px; padding:5px" placeholder="{{_'Search CxN'}}"></div>
            <ul id="cxnTree"></ul>
    </div>
    <div id="annoCenterPane" region="center" title="{{_'Constructional Annotation'}}" style="height: 100%">
        <div class="easyui-layout" style="width:100%;height:100%;">
            <div id="sentencesPane" region="north" style="width:100%;height:250px"   split="true" data-options="border:1"></div>
            <div id="layersPane" region="center" style="width:100%;height:300px" data-options="border:1"></div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var annotation = {
        isMaster: {{$data->isMaster|noescape}},
        isSenior: {{$data->isSenior|noescape}},
        rgbColors: JSON.parse({{$data->colors}}),
        layerType: JSON.parse({{$data->layerType}}),
        instantiationType: JSON.parse({{$data->instantiationType}}),
        instantiationTypeObj: JSON.parse({{$data->instantiationTypeObj}})
    };

    annotation.showSubCorpus = function (subCorpus) {
        $('#layersPane').html('');
        manager.doGet({{$manager->getURL('fnbr20/annotation/main/sentences')}} + '/' + subCorpus + '?cxn=1','sentencesPane');
    }

    $(function () {

        $('#annoLayout').layout();
        
        $('#cxn').textbox({
            buttonText:{{_'Search CxN'}},
            //iconCls:'icon-search',
            iconAlign:'right',
            prompt: {{_'Search CxN'}},
            onClickButton: function() {
                $('#cxnTree').tree({queryParams: {cxn: $('#cxn').textbox('getValue')}});
            }
        });
        
        $('#cxnTree').tree({
            url: {{$manager->getURL('fnbr20/annotation/main/cxnTree')}},
            onSelect: function (node) {
                console.log(node);
                if (node.id.charAt(0) == 's') {
                    annotation.showSubCorpus(node.id.substr(1));
                }
            }
        });
    });
</script>
